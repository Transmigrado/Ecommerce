{"version":3,"sources":["webpack://ecommerce/./src/pages/checkout/checkout.scss?797e","webpack://ecommerce/./src/pages/checkout/Checkout.jsx","webpack://ecommerce/./src/functions/validateEmail.js","webpack://ecommerce/./src/pages/checkout/checkout.scss"],"names":["options","history","useState","products","setProducts","total","setTotal","name","phone","email","address","formData","setFormData","formError","setFormError","dispatch","useDispatch","cart","useSelector","state","checkout","checking","setChecking","setName","setPhone","setEmail","setAddress","useEffect","reduce","curr","next","count","finalPrice","comprador","Box","className","Card","Grid","container","spacing","padding","item","xs","sm","md","lg","sx","width","TextField","defaultValue","error","id","label","variant","onChange","e","target","value","length","map","p","i","key","color","Button","onClick","test","validateEmail","checkoutInfo","window","localStorage","getItem","JSON","parse","push","res","filter","response","tail","unique","_","setItem","stringify","type","payload","toast","handleOrder","disabled","removeItem","___CSS_LOADER_EXPORT___","module"],"mappings":"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","file":"525.bundle.js","sourcesContent":["import api from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js!./checkout.scss\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import React, { useEffect, useState } from \"react\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { validateEmail } from '../../functions/validateEmail'\r\nimport \"react-quill/dist/quill.snow.css\";\r\nimport { toast } from \"react-toastify\";\r\nimport Card from '@mui/material/Card';\r\nimport Box from '@mui/material/Box';\r\nimport Grid from '@mui/material/Grid';\r\nimport Button from '@mui/material/Button';\r\nimport TextField from '@mui/material/TextField';\r\nimport _ from \"lodash\";\r\nimport \"./checkout.scss\"\r\n\r\nconst defaultValue = () => {\r\n    return {\r\n        name:'',\r\n        phone:'',\r\n        email:'',\r\n        address: ''\r\n    }\r\n}\r\n\r\nconst Checkout = ({ history }) => {\r\n\r\n    const [ products, setProducts ] = useState([]);\r\n    const [ total, setTotal ] = useState(0);\r\n    const [ formData, setFormData ] = useState(defaultValue())\r\n    const [ formError, setFormError ] = useState({})\r\n\r\n    const dispatch = useDispatch();\r\n    const { cart } = useSelector((state) => ({ ...state }));\r\n    const { checkout } = useSelector((state) => ({ ...state }));\r\n\r\n    const [ checking, setChecking ] = useState(true)\r\n    const [ name, setName] = useState()\r\n    const [ phone, setPhone ] = useState()\r\n    const [ email, setEmail ] = useState()\r\n    const [ address, setAddress] = useState()\r\n   \r\n    const thenEndpointAction = () => history.push(\"/payment\");\r\n\r\n    useEffect(() =>{\r\n        if(cart){\r\n            setProducts(cart)\r\n            let total = cart.reduce((curr, next) => curr + next.count * next.finalPrice, 0);\r\n            setTotal(total)\r\n        }\r\n    },[cart])\r\n\r\n    useEffect(() => {\r\n        setName(checkout[0]?.comprador?.name)\r\n        setPhone(checkout[0]?.comprador?.phone)\r\n        setEmail(checkout[0]?.comprador?.email)\r\n        setAddress(checkout[0]?.comprador?.address)\r\n\r\n        setFormData({\r\n            ... formData, \r\n            name: checkout[0]?.comprador?.name, \r\n            phone: checkout[0]?.comprador?.phone,\r\n            email: checkout[0]?.comprador?.email,\r\n            address: checkout[0]?.comprador?.address\r\n        })\r\n        setChecking(false)\r\n    },[checkout])\r\n    \r\n    const emptyCart = () => {\r\n        // remove from local storage\r\n        if (typeof window !== \"undefined\") {\r\n            localStorage.removeItem(\"cart\");\r\n            localStorage.removeItem(\"checkout\");\r\n        }\r\n        // remove from redux\r\n        dispatch({\r\n            type: \"ADD_TO_CART\",\r\n            payload: [],\r\n        });\r\n        dispatch({\r\n            type: \"ADD_TO_CHECKOUT\",\r\n            payload: [],\r\n        });\r\n\r\n    };\r\n\r\n    const handleOrder = () => {\r\n        let error = {}\r\n        if(!formData.name || !formData.phone || !formData.email || !formData.address){\r\n            if(!formData.name) error.name = true;\r\n            if(!formData.phone) error.phone = true;\r\n            if(!formData.email) error.email = true;\r\n            if(!formData.address) error.address = true;\r\n            toast.error(\"Debe completar la información solicitada.\");\r\n        } else if (!validateEmail(formData.email)) {\r\n            error.email = true;\r\n            toast.error(\"Debe ingresar un correo válido.\");\r\n        } else {\r\n            let checkoutInfo = {\r\n                comprador:formData,\r\n                products: products\r\n            }\r\n            let checkout = [];\r\n            if (typeof window !== \"undefined\") {\r\n                if (localStorage.getItem(\"checkout\")) {\r\n                    checkout = JSON.parse(localStorage.getItem(\"checkout\"));\r\n                }\r\n                if(checkout.length === 0){\r\n                    checkout.push({\r\n                        ...checkoutInfo,\r\n                        count: 1,\r\n                    });\r\n                } else {\r\n                    products.map((res) => {\r\n                        let products = checkout[0].products;\r\n                        let exists = products.filter((response) => response.tail === res.tail)\r\n                        if(exists.length === 0){\r\n                            checkout[0].products.push({\r\n                                ...res,\r\n                                count: 1,\r\n                            })\r\n                        }\r\n                    })\r\n                }\r\n            \r\n                let unique = _.uniqWith(checkout,_.isEqual);\r\n                localStorage.setItem(\"checkout\", JSON.stringify(unique));\r\n                \r\n                dispatch({\r\n                    type: \"ADD_TO_CHECKOUT\",\r\n                    payload: unique,\r\n                });\r\n                thenEndpointAction()\r\n            }\r\n        }\r\n        setFormError(error)\r\n    }\r\n\r\n    const showProductSummary = () =>\r\n        products.map((p, i) => (\r\n            <Box key={i}>\r\n                <p>\r\n                    {p.name} ({p.color}) x {p.count} ={\" \"}\r\n                    {p.finalPrice * p.count}\r\n                </p>\r\n            </Box>\r\n        ));\r\n\r\n    if(checking) return null\r\n\r\n    return (\r\n        <Box className=\"main-payment-container\">\r\n            <Card className=\"checkout-container\">\r\n                <Grid container spacing={4} padding={5} >\r\n                    <Grid item xs={12} sm={12} md={12} lg={12}>\r\n                        <h4>Datos del comprador</h4>\r\n                        <hr />\r\n                        <Box sx={{'& > :not(style)': {  width: '100%' },}}>\r\n                            <TextField\r\n                                defaultValue={ name ? name : \"\"}\r\n                                error={formError.name ? true : false } \r\n                                id=\"standard-basic\" \r\n                                label=\"Nombre\" \r\n                                variant=\"standard\" \r\n                                onChange={(e) => setFormData({... formData, name: e.target.value})}\r\n                            />\r\n                            <TextField\r\n                                defaultValue={ phone ? phone : \"\"}\r\n                                error={formError.phone ? true : false }\r\n                                id=\"standard-basic\" \r\n                                label=\"Teléfono\" \r\n                                variant=\"standard\" \r\n                                onChange={(e) => setFormData({... formData, phone: e.target.value})}\r\n                            />\r\n                            <TextField\r\n                                defaultValue={ email ? email : \"\"}\r\n                                error={formError.email ? true : false } \r\n                                id=\"standard-basic\" \r\n                                label=\"Correo\" \r\n                                variant=\"standard\" \r\n                                onChange={(e) => setFormData({... formData, email: e.target.value})}\r\n                            />\r\n                            <TextField\r\n                                defaultValue={ address ? address : \"\"}\r\n                                error={formError.address ? true : false } \r\n                                id=\"standard-basic\" \r\n                                label=\"Dirección de entrega\" \r\n                                variant=\"standard\" \r\n                                onChange={(e) => setFormData({... formData, address: e.target.value})}\r\n                            />\r\n                        </Box>\r\n                        <br/>\r\n                        <br/>\r\n                        <br/>\r\n                        <h4>Resumen del pedido</h4>\r\n                        <hr />\r\n                        <p>Products {products.length}</p>\r\n                        <hr />\r\n                        {showProductSummary()}\r\n                        <hr />\r\n        \r\n                        <p>Cart Total: {total}</p>\r\n\r\n                        <Box className=\"btn-order-summary\">\r\n                            <Box className=\"box-btn-order\">\r\n                                <Button\r\n                                    onClick={ () => handleOrder()}\r\n                                    variant=\"contained\"\r\n                                    className=\"btn-order-button\"\r\n                                    disabled={!products.length}\r\n                                >\r\n                                    Realizar pedido\r\n                                </Button>\r\n                            </Box>\r\n                            <Box className=\"btn-empty-cart\">\r\n                                <Button\r\n                                    variant=\"contained\"\r\n                                    disabled={!products.length}\r\n                                    onClick={emptyCart}\r\n                                    className=\"btn-empty-cart\"\r\n                                >\r\n                                    Vaciar carro\r\n                                </Button>\r\n                            </Box>\r\n                        </Box>\r\n                    </Grid> \r\n                </Grid>\r\n            </Card>\r\n        </Box> \r\n    );\r\n};\r\n\r\nexport default Checkout;\r\n","export const validateEmail = (email) => {\r\n    const re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n    return re.test(email);\r\n}","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".main-payment-container{display:flex;justify-content:center;padding-top:4rem;padding-bottom:6rem}.checkout-container{display:flex;justify-content:center;align-items:center;min-width:50%;padding-bottom:2rem}.btn-show-address{margin-top:1rem}.btn-order-summary{display:flex}.box-btn-order{margin-right:1rem}.btn-order-button{background:#000000 !important}.btn-order-button:hover{background:#00000096 !important}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/pages/checkout/checkout.scss\"],\"names\":[],\"mappings\":\"AAAA,wBACI,YAAa,CACb,sBAAuB,CACvB,gBAAiB,CACjB,mBAAoB,CACvB,oBAEG,YAAa,CACb,sBAAuB,CACvB,kBAAmB,CACnB,aAAc,CACd,mBAAoB,CACvB,kBAEG,eAAgB,CACnB,mBAEG,YAAa,CAChB,eAEG,iBAAkB,CACrB,kBAEC,6BAA8B,CAC/B,wBAEG,+BAAgC\",\"sourcesContent\":[\".main-payment-container {\\r\\n    display: flex;\\r\\n    justify-content: center;\\r\\n    padding-top: 4rem;\\r\\n    padding-bottom: 6rem;\\r\\n}\\r\\n.checkout-container {\\r\\n    display: flex;\\r\\n    justify-content: center;\\r\\n    align-items: center;\\r\\n    min-width: 50%;\\r\\n    padding-bottom: 2rem;\\r\\n}\\r\\n.btn-show-address {\\r\\n    margin-top: 1rem;\\r\\n}\\r\\n.btn-order-summary {\\r\\n    display: flex;\\r\\n}\\r\\n.box-btn-order {\\r\\n    margin-right: 1rem;\\r\\n}\\r\\n.btn-order-button {\\r\\n  background: #000000 !important;\\r\\n}\\r\\n.btn-order-button:hover {\\r\\n    background: #00000096 !important;\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n"],"sourceRoot":""}